function doGet(e) {
  Logger.log(JSON.stringify(e));  // Registra los par치metros recibidos

  var result = 'Ok';  // Supongamos que todo est치 bien por defecto
  
  if (!e || !e.parameter) {
    result = 'No Parameters';
  } else {
    var sheetId = '*****************************************************';  // ID de tu hoja de c치lculo
    var sheet = SpreadsheetApp.openById(sheetId).getActiveSheet();  // Abre la hoja activa
    var newRow = sheet.getLastRow() + 1;  // Encuentra la 칰ltima fila vac칤a

    // Leemos el ciclo de luz: "LUZ" o "OSCURIDAD"
    var cicloLuz = e.parameter.cicloLuz || "";  

    // Construye un array con los datos a registrar
    var rowData = [
      new Date(),                          // Fecha y hora actual
      e.parameter.maxHumidity    || "",    // Humedad m치xima
      e.parameter.minHumidity    || "",    // Humedad m칤nima
      e.parameter.maxTemperature || "",    // Temperatura m치xima
      e.parameter.minTemperature || "",    // Temperatura m칤nima
      e.parameter.maxVPD         || "",    // VPD m치ximo
      e.parameter.minVPD         || "",    // VPD m칤nimo
      cicloLuz                           // 游녣 NUEVA COLUMNA: "LUZ" / "OSCURIDAD"
    ];

    // Escribe los datos en la hoja de c치lculo
    sheet.getRange(newRow, 1, 1, rowData.length).setValues([rowData]);

    result = 'Datos escritos en la hoja de c치lculo';
  }

  return ContentService.createTextOutput(result);  // Devuelve un mensaje de estado
}
